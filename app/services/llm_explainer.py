"""Mock LLM Explainer Service

This module provides mock explanations for scam detections.
In production, this will be replaced with real LLM API calls (OpenAI, etc.)
"""
from typing import Tuple
import logging

logger = logging.getLogger(__name__)


# Mock explanations in Thai for each scam category
MOCK_EXPLANATIONS = {
    "parcel_scam": {
        "reason": "à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸¡à¸µà¸¥à¸±à¸à¸©à¸“à¸°à¸‚à¸­à¸‡à¸à¸²à¸£à¹à¸­à¸šà¸­à¹‰à¸²à¸‡à¹€à¸›à¹‡à¸™à¸šà¸£à¸´à¸©à¸±à¸—à¸‚à¸™à¸ªà¹ˆà¸‡ à¸à¸šà¸„à¸³à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡à¸à¸±à¸š 'à¸à¸±à¸ªà¸”à¸¸', 'à¸„à¹‰à¸²à¸‡à¸Šà¸³à¸£à¸°', 'à¸„à¹ˆà¸²à¸˜à¸£à¸£à¸¡à¹€à¸™à¸µà¸¢à¸¡' à¹à¸¥à¸°à¸¡à¸µà¸¥à¸´à¸‡à¸à¹Œà¸—à¸µà¹ˆà¸™à¹ˆà¸²à¸ªà¸‡à¸ªà¸±à¸¢ à¸‹à¸¶à¹ˆà¸‡à¹€à¸›à¹‡à¸™à¸£à¸¹à¸›à¹à¸šà¸šà¸à¸²à¸£à¸«à¸¥à¸­à¸à¸¥à¸§à¸‡à¸—à¸µà¹ˆà¸à¸šà¸šà¹ˆà¸­à¸¢à¹ƒà¸™à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™",
        "advice": "ğŸš« à¹„à¸¡à¹ˆà¸„à¸§à¸£à¸„à¸¥à¸´à¸à¸¥à¸´à¸‡à¸à¹Œà¹ƒà¸”à¹† à¹ƒà¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡\nâš ï¸ à¹„à¸¡à¹ˆà¸„à¸§à¸£à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸«à¸£à¸·à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸šà¸±à¸•à¸£à¹€à¸„à¸£à¸”à¸´à¸•\nâœ… à¸«à¸²à¸à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š à¸„à¸§à¸£à¸•à¸´à¸”à¸•à¹ˆà¸­à¸šà¸£à¸´à¸©à¸±à¸—à¸‚à¸™à¸ªà¹ˆà¸‡à¹‚à¸”à¸¢à¸•à¸£à¸‡à¸œà¹ˆà¸²à¸™à¸Šà¹ˆà¸­à¸‡à¸—à¸²à¸‡à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸›à¹‡à¸™à¸—à¸²à¸‡à¸à¸²à¸£\nâœ… à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸¥à¸‚à¸à¸±à¸ªà¸”à¸¸à¸œà¹ˆà¸²à¸™à¹à¸­à¸›à¸à¸¥à¸´à¹€à¸„à¸Šà¸±à¸™à¸«à¸£à¸·à¸­à¹€à¸§à¹‡à¸šà¹„à¸‹à¸•à¹Œà¸«à¸¥à¸±à¸à¸‚à¸­à¸‡à¸šà¸£à¸´à¸©à¸±à¸—"
    },
    "banking_scam": {
        "reason": "à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸à¸¢à¸²à¸¢à¸²à¸¡à¹à¸­à¸šà¸­à¹‰à¸²à¸‡à¹€à¸›à¹‡à¸™à¸˜à¸™à¸²à¸„à¸²à¸£ à¸¡à¸µà¸à¸²à¸£à¸à¸¥à¹ˆà¸²à¸§à¸­à¹‰à¸²à¸‡à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¸šà¸±à¸•à¸£à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸, à¸à¸²à¸£à¸¢à¸·à¸™à¸¢à¸±à¸™à¸•à¸±à¸§à¸•à¸™ à¸«à¸£à¸·à¸­ OTP à¸˜à¸™à¸²à¸„à¸²à¸£à¸—à¸µà¹ˆà¹à¸—à¹‰à¸ˆà¸£à¸´à¸‡à¸ˆà¸°à¹„à¸¡à¹ˆà¸‚à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸œà¹ˆà¸²à¸™ SMS à¸«à¸£à¸·à¸­à¸¥à¸´à¸‡à¸à¹Œ",
        "advice": "ğŸš« à¸˜à¸™à¸²à¸„à¸²à¸£à¸ˆà¸°à¹„à¸¡à¹ˆà¸‚à¸­à¸£à¸«à¸±à¸ª OTP à¸«à¸£à¸·à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸šà¸±à¸•à¸£à¸œà¹ˆà¸²à¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡\nâš ï¸ à¸­à¸¢à¹ˆà¸²à¸à¸£à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¹ƒà¸™à¹€à¸§à¹‡à¸šà¹„à¸‹à¸•à¹Œà¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹à¸™à¹ˆà¹ƒà¸ˆ\nâœ… à¹‚à¸—à¸£à¸•à¸´à¸”à¸•à¹ˆà¸­à¸˜à¸™à¸²à¸„à¸²à¸£à¸œà¹ˆà¸²à¸™à¸«à¸¡à¸²à¸¢à¹€à¸¥à¸‚à¸šà¸™à¸šà¸±à¸•à¸£ ATM à¸«à¸£à¸·à¸­à¹à¸­à¸›à¸à¸¥à¸´à¹€à¸„à¸Šà¸±à¸™à¸˜à¸™à¸²à¸„à¸²à¸£\nâœ… à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š URL à¸§à¹ˆà¸²à¹€à¸›à¹‡à¸™à¸‚à¸­à¸‡à¸˜à¸™à¸²à¸„à¸²à¸£à¸ˆà¸£à¸´à¸‡ (à¸”à¸¹ https à¹à¸¥à¸°à¸Šà¸·à¹ˆà¸­à¹‚à¸”à¹€à¸¡à¸™)"
    },
    "prize_scam": {
        "reason": "à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸­à¹‰à¸²à¸‡à¸§à¹ˆà¸²à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸šà¸£à¸²à¸‡à¸§à¸±à¸¥ à¹à¸ˆà¹‡à¸„à¸à¸­à¸• à¸«à¸£à¸·à¸­à¸‚à¸­à¸‡à¸£à¸²à¸‡à¸§à¸±à¸¥à¸•à¹ˆà¸²à¸‡à¹† à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸ªà¸¡à¸±à¸„à¸£à¸«à¸£à¸·à¸­à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¹ƒà¸”à¹† à¸™à¸µà¹ˆà¸„à¸·à¸­à¸à¸¥à¸¢à¸¸à¸—à¸˜à¹Œà¸—à¸±à¹ˆà¸§à¹„à¸›à¹ƒà¸™à¸à¸²à¸£à¸«à¸¥à¸­à¸à¹ƒà¸«à¹‰à¸„à¸¥à¸´à¸à¸¥à¸´à¸‡à¸à¹Œà¸«à¸£à¸·à¸­à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§",
        "advice": "ğŸš« à¸«à¸²à¸à¹„à¸¡à¹ˆà¹€à¸„à¸¢à¸ªà¸¡à¸±à¸„à¸£à¸«à¸£à¸·à¸­à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¸à¸´à¸ˆà¸à¸£à¸£à¸¡ à¹„à¸¡à¹ˆà¸¡à¸µà¸—à¸²à¸‡à¹„à¸”à¹‰à¸£à¸±à¸šà¸£à¸²à¸‡à¸§à¸±à¸¥\nâš ï¸ à¸­à¸¢à¹ˆà¸²à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸«à¸£à¸·à¸­à¹‚à¸­à¸™à¹€à¸‡à¸´à¸™ 'à¸„à¹ˆà¸²à¸˜à¸£à¸£à¸¡à¹€à¸™à¸µà¸¢à¸¡' à¹ƒà¸”à¹†\nâœ… à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸à¸±à¸šà¸šà¸£à¸´à¸©à¸±à¸—à¸«à¸£à¸·à¸­à¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸­à¹‰à¸²à¸‡à¸§à¹ˆà¸²à¹ƒà¸«à¹‰à¸£à¸²à¸‡à¸§à¸±à¸¥à¹‚à¸”à¸¢à¸•à¸£à¸‡\nâœ… à¸£à¸°à¸§à¸±à¸‡à¸£à¸²à¸‡à¸§à¸±à¸¥à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡ 'à¸ˆà¹ˆà¸²à¸¢à¹€à¸‡à¸´à¸™à¸à¹ˆà¸­à¸™' à¹€à¸à¸·à¹ˆà¸­à¸£à¸±à¸šà¸£à¸²à¸‡à¸§à¸±à¸¥"
    },
    "investment_scam": {
        "reason": "à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸Šà¸·à¹‰à¸­à¹€à¸Šà¸´à¸à¹ƒà¸«à¹‰à¸¥à¸‡à¸—à¸¸à¸™à¹‚à¸”à¸¢à¸ªà¸±à¸à¸à¸²à¸œà¸¥à¸•à¸­à¸šà¹à¸—à¸™à¸ªà¸¹à¸‡, à¸£à¸§à¸¢à¹€à¸£à¹‡à¸§, à¸«à¸£à¸·à¸­à¸£à¸²à¸¢à¹„à¸”à¹‰à¹€à¸ªà¸£à¸´à¸¡à¸—à¸µà¹ˆà¸”à¸¹à¸”à¸µà¹€à¸à¸´à¸™à¸ˆà¸£à¸´à¸‡ à¸à¸²à¸£à¸¥à¸‡à¸—à¸¸à¸™à¸—à¸µà¹ˆà¹à¸—à¹‰à¸ˆà¸£à¸´à¸‡à¸¡à¸µà¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡ à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¸£à¸±à¸šà¸›à¸£à¸°à¸à¸±à¸™à¸à¸³à¹„à¸£",
        "advice": "ğŸš« à¸£à¸°à¸§à¸±à¸‡à¸à¸²à¸£à¸¥à¸‡à¸—à¸¸à¸™à¸—à¸µà¹ˆà¸ªà¸±à¸à¸à¸²à¸œà¸¥à¸•à¸­à¸šà¹à¸—à¸™à¸ªà¸¹à¸‡à¹à¸šà¸šà¹„à¸¡à¹ˆà¸¡à¸µà¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡\nâš ï¸ à¸­à¸¢à¹ˆà¸²à¹‚à¸­à¸™à¹€à¸‡à¸´à¸™à¹ƒà¸«à¹‰à¸à¸±à¸šà¸„à¸™à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸ˆà¸±à¸à¸«à¸£à¸·à¸­à¸šà¸£à¸´à¸©à¸±à¸—à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸¡à¸µà¹ƒà¸šà¸­à¸™à¸¸à¸à¸²à¸•\nâœ… à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸šà¸£à¸´à¸©à¸±à¸—à¸¡à¸µà¹ƒà¸šà¸­à¸™à¸¸à¸à¸²à¸•à¸ˆà¸²à¸ à¸.à¸¥.à¸•. (www.sec.or.th)\nâœ… à¸¨à¸¶à¸à¸©à¸²à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸¥à¸‡à¸—à¸¸à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸à¹ˆà¸­à¸™à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ"
    },
    "impersonation_scam": {
        "reason": "à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸­à¸šà¸­à¹‰à¸²à¸‡à¹€à¸›à¹‡à¸™à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸‚à¸­à¸‡à¸£à¸±à¸ à¹€à¸Šà¹ˆà¸™ à¸•à¸³à¸£à¸§à¸ˆ, à¸¨à¸²à¸¥, DSI à¹‚à¸”à¸¢à¸­à¹‰à¸²à¸‡à¸§à¹ˆà¸²à¸¡à¸µà¸à¸²à¸£à¸à¸£à¸°à¸—à¸³à¸œà¸´à¸”à¹à¸¥à¸°à¸‚à¸­à¹ƒà¸«à¹‰à¹‚à¸­à¸™à¹€à¸‡à¸´à¸™à¸«à¸£à¸·à¸­à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ à¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™à¸£à¸²à¸Šà¸à¸²à¸£à¸ˆà¸£à¸´à¸‡à¸ˆà¸°à¹„à¸¡à¹ˆà¸•à¸´à¸”à¸•à¹ˆà¸­à¸œà¹ˆà¸²à¸™ SMS",
        "advice": "ğŸš« à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸‚à¸­à¸‡à¸£à¸±à¸à¸ˆà¸°à¹„à¸¡à¹ˆà¸‚à¸­à¹ƒà¸«à¹‰à¹‚à¸­à¸™à¹€à¸‡à¸´à¸™à¸œà¹ˆà¸²à¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸«à¸£à¸·à¸­à¹‚à¸—à¸£à¸¨à¸±à¸à¸—à¹Œ\nâš ï¸ à¸­à¸¢à¹ˆà¸²à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸«à¸£à¸·à¸­à¸«à¸¡à¸²à¸¢à¹€à¸¥à¸‚à¸šà¸±à¸•à¸£à¸›à¸£à¸°à¸Šà¸²à¸Šà¸™\nâœ… à¸•à¸´à¸”à¸•à¹ˆà¸­à¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸­à¹‰à¸²à¸‡à¹‚à¸”à¸¢à¸•à¸£à¸‡à¸œà¹ˆà¸²à¸™à¸«à¸¡à¸²à¸¢à¹€à¸¥à¸‚à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸›à¹‡à¸™à¸—à¸²à¸‡à¸à¸²à¸£\nâœ… à¸«à¸²à¸à¹„à¸¡à¹ˆà¹à¸™à¹ˆà¹ƒà¸ˆ à¹à¸ˆà¹‰à¸‡à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¸ªà¸–à¸²à¸™à¸µà¸•à¸³à¸£à¸§à¸ˆ"
    },
    "safe": {
        "reason": "à¹„à¸¡à¹ˆà¸à¸šà¸ªà¸±à¸à¸à¸²à¸“à¸‚à¸­à¸‡à¸à¸²à¸£à¸«à¸¥à¸­à¸à¸¥à¸§à¸‡à¹ƒà¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸™à¸µà¹‰ à¹à¸•à¹ˆà¸„à¸§à¸£à¸£à¸°à¸¡à¸±à¸”à¸£à¸°à¸§à¸±à¸‡à¹€à¸ªà¸¡à¸­à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸à¸²à¸£à¸‚à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸«à¸£à¸·à¸­à¸à¸²à¸£à¸—à¸³à¸˜à¸¸à¸£à¸à¸£à¸£à¸¡à¸—à¸²à¸‡à¸à¸²à¸£à¹€à¸‡à¸´à¸™",
        "advice": "âœ… à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸”à¸¹à¸›à¸à¸•à¸´ à¹à¸•à¹ˆà¸„à¸§à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡à¸à¹ˆà¸­à¸™à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¹ƒà¸”à¹†\nâš ï¸ à¸­à¸¢à¹ˆà¸²à¹ƒà¸«à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸«à¸£à¸·à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¹€à¸‡à¸´à¸™à¸«à¸²à¸à¹„à¸¡à¹ˆà¹à¸™à¹ˆà¹ƒà¸ˆ\nâœ… à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸„à¸§à¸²à¸¡à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¸ªà¹ˆà¸‡à¸à¹ˆà¸­à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸–à¸·à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥"
    }
}


def explain_with_llm(message: str, category: str) -> Tuple[str, str]:
    """
    Generate explanation using LLM (MOCK implementation)
    
    Args:
        message: à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¸•à¸£à¸§à¸ˆà¸à¸š
        category: à¸›à¸£à¸°à¹€à¸ à¸—à¸‚à¸­à¸‡à¸à¸²à¸£à¸«à¸¥à¸­à¸à¸¥à¸§à¸‡
        
    Returns:
        Tuple of (reason, advice)
        - reason: à¹€à¸«à¸•à¸¸à¸œà¸¥à¸—à¸µà¹ˆà¸•à¸£à¸§à¸ˆà¸à¸šà¸§à¹ˆà¸²à¹€à¸›à¹‡à¸™à¸à¸²à¸£à¸«à¸¥à¸­à¸à¸¥à¸§à¸‡
        - advice: à¸„à¸³à¹à¸™à¸°à¸™à¸³à¹ƒà¸™à¸à¸²à¸£à¸›à¹‰à¸­à¸‡à¸à¸±à¸™
    """
    logger.info(f"Generating explanation for category: {category}")
    
    # Get mock explanation for the category
    explanation = MOCK_EXPLANATIONS.get(
        category,
        MOCK_EXPLANATIONS["safe"]
    )
    
    reason = explanation["reason"]
    advice = explanation["advice"]
    
    logger.info("Explanation generated successfully")
    
    return reason, advice


# Interface for future real LLM integration
class LLMExplainerInterface:
    """
    Interface for LLM explainer implementations.
    Future implementations (OpenAI, Anthropic, etc.) can inherit from this class.
    """
    
    def explain(self, message: str, category: str) -> Tuple[str, str]:
        """Generate explanation for a scam classification"""
        raise NotImplementedError
    
    def get_version(self) -> str:
        """Get LLM version"""
        raise NotImplementedError


class MockLLMExplainer(LLMExplainerInterface):
    """Mock implementation of LLM explainer"""
    
    def __init__(self):
        self.version = "mock-v1.0"
    
    def explain(self, message: str, category: str) -> Tuple[str, str]:
        return explain_with_llm(message, category)
    
    def get_version(self) -> str:
        return self.version


class OpenAILLMExplainer(LLMExplainerInterface):
    """
    Placeholder for future OpenAI LLM implementation
    Will use OPENAI_API_KEY from config
    """
    
    def __init__(self, api_key: str):
        self.api_key = api_key
        self.version = "openai-v1.0"
    
    def explain(self, message: str, category: str) -> Tuple[str, str]:
        # TODO: Implement OpenAI API call
        # This is a placeholder for future implementation
        raise NotImplementedError("OpenAI integration not yet implemented")
    
    def get_version(self) -> str:
        return self.version
